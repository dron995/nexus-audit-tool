# Nexus Repository Security Auditor
–£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –∞—É–¥–∏—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ Nexus OSS. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π API –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

## üìã –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ —á–µ—Ä–µ–∑ Nexus API
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞–∂–¥–æ–º—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º (hosted/proxy/group) –∏ —Ñ–æ—Ä–º–∞—Ç–∞–º (maven2/docker/npm –∏ –¥—Ä.)
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JSON –æ—Ç—á–µ—Ç–∞ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
- –≠–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Prometheus
- –û—Ç–ø—Ä–∞–≤–∫–∞ email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∞—É–¥–∏—Ç–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```
requirements.txt:

```text
requests>=2.28.0
pyyaml>=6.0
urllib3>=1.26.0
```
### –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
```yaml
# config.yaml
nexus:
  url: "https://nexus.example.com"
  username: "admin"
  password: "admin123"

ssl:
  rootCA: "/path/to/ca.pem"  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
  verify_ssl: true

audit:
  repository_types: ["hosted", "proxy"]
  repository_formats: ["maven2", "docker"]
  exclude_file: "excluded_repos.txt"

prometheus:
  enabled: true
  file: "/var/lib/node_exporter/nexus_audit.prom"

email:
  enabled: true
  smtp_host: "localhost"
  smtp_port: 25
  from_email: "nexus-auditor@example.com"
  to_emails: ["admin@example.com", "security@example.com"]
  ```
  
## üéØ –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|---|---|---|
| -c, --config |	–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π. –ü—É—Ç—å –∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º—É —Ñ–∞–π–ª—É	 | -c config.yaml |
| -o, --output |	–ü—É—Ç—å –∫ —Ñ–∞–π–ª—É JSON –æ—Ç—á–µ—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: nexus_audit_report.json) | 	-o report.json |
| -v, --verbose	| –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ –ª–æ–≥–æ–≤ | 	-v |
| --debug-ssl	|–û—Ç–ª–∞–¥–∫–∞ SSL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π | 	--debug-ssl |

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|---|---|---|
| --repo-types |	–¢–∏–ø—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é) |	--repo-types hosted,proxy |
| --repo-formats |	–§–æ—Ä–º–∞—Ç—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ |	--repo-formats maven2,docker |
| --repo-formats "" |	–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –í–°–ï —Ñ–æ—Ä–º–∞—Ç—ã |	--repo-formats "" |
| --list-formats |	–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ |	--list-formats |

### Prometheus –º–µ—Ç—Ä–∏–∫–∏
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|---|---|---|
| --prometheus |	–í–∫–ª—é—á–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫ Prometheus |	--prometheus |
| --no-prometheus |	–û—Ç–∫–ª—é—á–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫ Prometheus |	--no-prometheus |
| --prometheus-file |	–ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –º–µ—Ç—Ä–∏–∫ Prometheus | --prometheus-file /metrics/nexus.prom |

### Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|---|---|---|
| --email	| –í–∫–ª—é—á–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É email	| --email |
| --no-email |	–û—Ç–∫–ª—é—á–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É email |	--no-email |
| --email-to |	–ü–æ–ª—É—á–∞—Ç–µ–ª–∏ email (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é) |	--email-to admin@ex.com,sec@ex.com |
| --test-email |	–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π email –∏ –≤—ã–π—Ç–∏ |	--test-email |

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
### –ë–∞–∑–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
``` bash
# 1. –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ config.yaml)
python nexus_auditor.py -c config.yaml

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ hosted —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
python nexus_auditor.py -c config.yaml --repo-types hosted

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ Maven –∏ Docker —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
python nexus_auditor.py -c config.yaml --repo-formats maven2,docker

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ñ–æ—Ä–º–∞—Ç–∞
python nexus_auditor.py -c config.yaml --repo-formats ""

# 5. –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ —Å –æ—Ç–ª–∞–¥–∫–æ–π SSL
python nexus_auditor.py -c config.yaml -v --debug-ssl
```
### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
``` bash
# 1. –° Prometheus –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∏ email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
python nexus_auditor.py -c config.yaml --prometheus --email

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π email
python nexus_auditor.py -c config.yaml --email --email-to admin@example.com

# 3. –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: —Ç–æ–ª—å–∫–æ proxy —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∞ docker
python nexus_auditor.py -c config.yaml --repo-types proxy --repo-formats docker

# 4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–∞ –≤ —É–∫–∞–∑–∞–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
python nexus_auditor.py -c config.yaml -o /reports/nexus_audit_$(date +%Y%m%d).json

# 5. –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ email
python nexus_auditor.py -c config.yaml --test-email
``` 

## üìä –§–æ—Ä–º–∞—Ç—ã –≤—ã–≤–æ–¥–∞
### JSON –æ—Ç—á–µ—Ç
```json
{
  "audit_configuration": { ... },
  "summary": {
    "total_repositories": 25,
    "checked": 20,
    "vulnerable": 2,
    "secure": 15,
    "requires_manual_check": 3,
    "errors": 0
  },
  "results": [ ... ],
  "vulnerable_repositories": [ ... ]
}
```

### Prometheus –º–µ—Ç—Ä–∏–∫–∏
``` prometheus
# HELP nexus_audit_repositories_total Total number of repositories in Nexus
# TYPE nexus_audit_repositories_total gauge
nexus_audit_repositories_total{nexus="https://nexus.example.com"} 25

# HELP nexus_audit_repositories_vulnerable Number of repositories with public access
# TYPE nexus_audit_repositories_vulnerable gauge
nexus_audit_repositories_vulnerable{nexus="https://nexus.example.com"} 2
```

### Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ SMTP localhost:25 –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –°–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–∫—Å—Ç–æ–≤—É—é –∏ HTML –≤–µ—Ä—Å–∏—é
- –¢–µ–º–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–∞—Ç—É—Å –∞—É–¥–∏—Ç–∞ (CRITICAL/WARNING/SUCCESS)

### üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏—Å–∫–ª—é—á–µ–Ω–∏–π
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª excluded_repos.txt:

``` text
# –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, –∏—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ –∏–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏
test-repository
temp-storage
public-repo
# –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å #
```

## üö® –ö–æ–¥—ã –≤–æ–∑–≤—Ä–∞—Ç–∞
| –ö–æ–¥ |	–û–ø–∏—Å–∞–Ω–∏–µ | –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ |
|---|---|---|
| 0 |	–£—Å–ø–µ—à–Ω–æ, —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ | - |
| 1 |	–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Å –ø—É–±–ª–∏—á–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º	| –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Nexus |
| 2 |	–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞—É–¥–∏—Ç–∞ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –ª–æ–≥–∏ |
| 3 |	–ú–Ω–æ–≥–æ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ |	–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Nexus |
| 130 |	–ü—Ä–µ—Ä–≤–∞–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º (Ctrl+C) | - |

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```text
nexus-auditor/
‚îú‚îÄ‚îÄ nexus_auditor.py      # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ email_sender.py       # –ú–æ–¥—É–ª—å –æ—Ç–ø—Ä–∞–≤–∫–∏ email
‚îú‚îÄ‚îÄ config.yaml           # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ excluded_repos.txt    # –ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
‚îú‚îÄ‚îÄ requirements.txt      # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îî‚îÄ‚îÄ README.md            # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
–•—Ä–∞–Ω–µ–Ω–∏–µ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
–£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ Nexus —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º —Ñ–∞–π–ª–µ
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª—É: chmod 600 config.yaml
–î–ª—è production –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã/—Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –ø–∞—Ä–æ–ª–µ–π

### SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ CA —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
–ú–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É SSL (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–º–µ–Ω–∏ —Ö–æ—Å—Ç–∞

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
Prometheus + Grafana
–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Prometheus –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ –∏–∑ —Ñ–∞–π–ª–∞
–ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞—à–±–æ—Ä–¥ Grafana –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
–õ–æ–≥–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å –∏ –≤ —Ñ–∞–π–ª nexus_audit.log

–£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ -v —Ñ–ª–∞–≥

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç
–§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
–°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è —Ñ–∏—á–∏
–ó–∞—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
–û—Ç–ø—Ä–∞–≤—å—Ç–µ pull request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è
MIT License

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞
- –ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: tail -f nexus_audit.log
- –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Nexus API
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å —Ñ–ª–∞–≥–æ–º -v –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞

